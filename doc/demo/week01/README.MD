# 도메일 모델 시작

## 도메인

* 소프트웨어로 해결하고자 하는 문제 영역

> 이전 나의 생각 : 비즈니스의 적용 대상

* 한 하위 도메인은 다른 하위 도메인과 연동하여 완전한 기능을 제공한다.
* 특정 도메인을 위한 소프트웨어라고 해서 도메인이 제공해야 할 모든 기능을 구현하는 것은 아니다, 외부 시스템을 사용하는 경우도 있음
* 도메인마다 규모나 특성에 따라 고정된 하위 도메인이 존재하는건 아님

## 도메인 모델

* 도메인 모델은 특정 도메인을 개념적으로 표현한 것
* 보통 UML 이라는 것으로 표현, 표현하기 위해 의사 소통이 된다면 어떠한 형식이든 가능

> 하위 도메인이 다루는 영역은 서로 다르기 때문에 같은 용어라도 하위 도메인마다 의미가 달라질 수 있다.
> 도메인에 따라 용어의 의미가 결정되므로, 여러 하위 도메인을 하나의 다이어그램에 모델링하면 안된다.

## 도메인 모델 패턴

> 일반적인 애플리케이션 아키텍처
> 표현 계층 : 사용자의 요청을 처리하고 정보를 보여줌
> 응용 계층 : 요청한 기능을 실행, 도메인 계층을 조합해서 기능을 실행
> 도메인 : 시스템이 제공할 도메인의 규칙을 구현
> 인프라스트럭처 : 데이터베이스같은 외부 시스템과의 연동을 처리

* 여기서 '**도메인 모델**'은 아키텍처상의 도메인 계층을 객체 지향 기법으로 구현하는 패턴을 말함
* 핵심 규칙을 구현한 코드는 도메인 모델에만 위치하기 때문에 규칙이 바뀌거나 규칙을 확장해야 할 때 다른 코드에 영향을 덜 주고 변경내역을 모델이 반영할 수 있음

## 도메인 모델 도출

* 요구사항 및 분석을 통해 도메인을 이해하고 이를 바탕으로 도메인 모델 초안을 만들어야한다.

## 엔티티와 밸류

* 도출한 모델은 크게 엔티티와 밸류로 구분할 수 있다.
* 엔티티와 밸류를 제대로 구분해야 도메인을 올바르게 설계하고 구현할 수 있다.

### 엔티티

* 엔티티의 가장 큰 특징은 식별자를 갖는다는 것, 각 엔티티는 서로 다른 식별자를 갖는다.
* 엔티티의 식별자는 바뀌지 않는다.
* 두 엔티티 객체의 식별자 같으면 두 엔티티는 같다고 판단

### 엔티티의 식별자 생성

* 엔티티의 식별자를 생성하는 시점은 도메인의 특징과 사용하는 기술에 따라 달라짐
* 특정 규칙, UUID, 값을 직접 입력, 일련번호 사용 등, 시간을 사용하는 경우도 있는데 이때는 같은 식별자가 만들어 질 수 있으니 조심해야 함
* 식별자 값을 직접 입력하는 경우는 중복 방지를 해야 한다.
* 일련번호는 주로 데이터베이스가 지원하는 자동 증가 기능을 사용, 다른점은 디비에 데이터를 입력해야 식별자 값을 알 수 있음

### 밸류 타입

* 밸류 타입은 개념적으로 완전한 하나를 표현할 때 사용
* 밸류 타입을 사용함으로써 개념적으로 완전한 하나를 잘 표현할 수 있다.
* 두 개 이상의 데이터를 가져야 하는건 아님, 의미를 명확하게 표현학 위해 밸류 타입을 사용 하기도 함 (Money)
* 안전한 코드 작성을 위해 밸류 타입은 불변타입이 잘 어울림
* 밸류타입은 모든 속성이 같아야 동일한 객체

### 엔티티 식별자와 밸류 타입

* 식별자는 도메인에서 특별한 의미를 지니는 경우가 있음
* 이때 식별자를 위한 밸류타입을 사용해서 의미가 잘 드러날 수 있도록 작성 가능 (OrderNo)

### 도메인 모델에 set 메서드 넣지 않기

* 도메인의 핵심 개념이나 의도를 코드에서 사라지게 함
* 상태 변경과 관련된 도메인 지식이 코드에서 사라지게 됨
* set을 통해 생성한 객체에 데이터를 전달할 때 누락이 발생할 가능성이 있음, 생성 시점에 전달하는게 안전함
* 불변 밸류타입을 사용하여 자연스럽게 set 메서드를 제거

## 도메인 용어

* 도메인에서 사용하는 용어를 코드에 반영하지 않으면 그 코드는 개발자에게 코드의 의미를 해석해야 하는 부담을 줌
* 코드의 가독성을 높여 분석하고 이해하는 시간을 절약해줌


